
## 브랜치의 기술적 구현

Iceberg에서 "type": "branch"는 Git의 브랜치 개념과 유사한 방식으로 구현되었습니다:

1. **참조 포인터(Reference Pointer)**: 브랜치는 본질적으로 특정 스냅샷 ID를 가리키는 포인터입니다. 메타데이터에서 "refs" 섹션의 "main" 브랜치는 현재 활성화된 스냅샷(8333017788700497002)을 가리킵니다.
2. **동적 참조**: 브랜치는 고정된 참조가 아닌 동적 참조입니다. 새 스냅샷이 생성될 때마다 브랜치는 자동으로 최신 스냅샷을 가리키도록 업데이트됩니다.
3. **메타데이터 관리**: 모든 브랜치 정보는 메타데이터 파일(v2.metadata.json)에 저장되어 테이블 상태의 버전 관리를 가능하게 합니다.

## 브랜치와 스냅샷의 관계

복사

`"current-snapshot-id" : 8333017788700497002, "refs" : {     "main" : {        "snapshot-id" : 8333017788700497002,        "type" : "branch"    } },`

위 코드에서:

- `current-snapshot-id`는 현재 활성 스냅샷을 나타냅니다
- `refs.main`은 메인 브랜치를 정의합니다
- 두 값이 같은 스냅샷 ID를 가리키므로, 현재 메인 브랜치가 활성 상태임을 의미합니다

## 실제 사용 사례

브랜치의 실제 활용 방법:

1. **데이터 실험**: 새 브랜치를 생성하여 메인 데이터에 영향을 주지 않고 변환 작업을 테스트
2. **독립적 작업 흐름**:
    
    sql
    
    복사
    
    `-- 브랜치 생성 CREATE BRANCH development IN my_table; -- 개발 브랜치에 데이터 삽입/수정 INSERT INTO my_table.branch_development VALUES (...); -- 변경사항 테스트 후 메인으로 병합 MERGE BRANCH development INTO main IN my_table;`
    
3. **롤백 메커니즘**: 문제 발생 시 이전 브랜치나 스냅샷으로 쉽게 되돌릴 수 있음
4. **병렬 개발**: 여러 팀이 동일한 테이블에서 독립적으로 작업 가능

## 다른 참조 타입과의 비교

- **브랜치(Branch)**: 동적 참조로, 새 작업이 추가되면 자동으로 업데이트됨
- **태그(Tag)**: 고정 참조로, 특정 스냅샷을 영구적으로 표시(예: "production", "v1.0")
- **스냅샷 ID**: 직접적인 참조지만 숫자로만 되어 있어 이해하기 어려움

Iceberg의 브랜치 기능은 데이터 버전 관리, 격리된 실험 및 협업 작업 흐름을 가능하게 하는 강력한 기능입니다.